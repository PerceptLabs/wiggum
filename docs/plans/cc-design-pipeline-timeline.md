# Wiggum Design Pipeline Timeline

> The concrete plan for closing every gap between what Ralph builds today and what Ralph should build.
> Focused exclusively on **design quality output** â€” theme, personality, composition, diversity, iteration.
> Build infrastructure (PWA, ESM cache, ZenFS), full-stack (Hono), and orchestration (Chief) live in `cc-implementation-timeline.md`.

> **How to read this:** Each phase = one CC prompt doc that gets fed to Claude Code.
> Phase 1 is fully specced. Phases 2-3 are skeletons â€” the plan docs need to be completed before CC execution.
> Always feed CC `wiggum-master.md` alongside the phase-specific doc.

> **Last audited against codebase:** 2026-02-16. This timeline was verified by reading every file
> in `src/lib/theme-generator/`, `src/skills/`, `src/lib/shell/`, `src/lib/preview/`, and `src/lib/ralph/`.

---

## What Exists Today (Baseline)

Before reading the phases, here's what's built and working. This inventory is verified against actual source files.

### Theme Generator (`src/lib/theme-generator/`)

| Piece | Status | Where |
|-------|--------|-------|
| Sacred geometry OKLCH engine (11 patterns) | âœ… Built | `generator.ts`, `patterns.ts` |
| 12 curated presets | âœ… Built | `themes/` directory |
| 50+ CSS variable output (`:root` + `.dark`) | âœ… Built | `theme preset --apply`, `theme generate --apply` |
| Font registry (32 curated Google Fonts, 7 categories) | âœ… Built | `personality.ts` |
| Shadow profiles (5: noneâ†’harsh) | âœ… Built | `personality.ts` |
| Radius stops (5: noneâ†’pill) | âœ… Built | `personality.ts` |
| WCAG AA contrast enforcement (4.5:1 minimum) | âœ… Built | `generator.ts` contrast pairs |
| DTCG tokens.json output (W3C format) | âœ… Built | `dtcg.ts` |
| Pattern aliases (elegantâ†’analogous, boldâ†’complementary, etc.) | âœ… Built | `theme.ts` shell command |

### Personality & Mood System (`src/lib/theme-generator/personalities.ts`)

| Piece | Status | Where |
|-------|--------|-------|
| 12 typed mood presets (NOT 6) | âœ… Built | `personalities.ts` â€” minimal, premium, playful, industrial, organic, editorial, fashion-editorial, brutalist, zen, corporate, retro, luxury |
| Full PersonalityBrief per mood | âœ… Built | Each mood has: philosophy, typography hierarchy (5 levels), animation timing (5 types), spacing rhythm, interaction patterns, allowed/notAllowed rules, quality checklist |
| `generateDesignBrief()` â†’ markdown output | âœ… Built | Renders complete design-brief.md from mood data |
| `--mood` flag on both `theme preset` AND `theme generate` | âœ… Built | `theme.ts` â€” works independently of presets |
| Auto-inferred moods per preset | âœ… Built | `PRESET_MOOD_MAP` (cyberpunkâ†’industrial, soft-popâ†’playful, monoâ†’minimal, etc.) |
| `theme list moods` | âœ… Built | Shows all 12 with descriptions |

### Shell Commands (`src/lib/shell/commands/theme.ts`)

| Piece | Status | Where |
|-------|--------|-------|
| `theme preset <name> [--mood] [--apply]` | âœ… Built | Writes CSS + design-brief.md + tokens.json |
| `theme generate --seed --pattern [--mood] [--font] [--shadow-profile] [--radius] [--apply]` | âœ… Built | Full custom generation |
| `theme modify --shift-hue <Â±deg> [--scope brand/surface/all] [--apply]` | âœ… Built | Patches CSS + tokens.json in sync, contrast re-enforced |
| `theme list presets/patterns/fonts/shadows/radii/moods` | âœ… Built | All 6 subcommands |

### Smart CSS Merge (`src/lib/shell/css-smart-merge.ts`)

| Piece | Status | Where |
|-------|--------|-------|
| Theme zone protection (marker-based) | âœ… Built | Detects `/* Generated by theme command` marker |
| WCAG contrast validation on color overrides | âœ… Built | Checks against contrast pairs, rejects < 4.5:1 |
| Non-color override passthrough | âœ… Built | Fonts, radius, spacing always accepted |
| Custom CSS append zone | âœ… Built | Routes non-theme CSS outside theme block |
| `@fonts` comment extraction | âœ… Built | Preserves across merges |
| Full rewrite passthrough (when incoming has marker) | âœ… Built | `theme --apply` bypasses merge |
| Merge report with override counts | âœ… Built | Reports accepted/skipped with reasons |

### Preview System (`src/lib/preview/snapshot.ts`)

| Piece | Status | Where |
|-------|--------|-------|
| 3-layer snapshot (theme + structure + render) | âœ… Built | `generateSnapshot()` |
| Layer 1: Theme from tokens.json (rich) OR CSS (fallback) | âœ… Built | `snapshotTheme()` â€” tries tokens.json first |
| Layer 2: Structure analysis (imports, Tailwind, JSX) | âœ… Built | `snapshotStructure()` |
| Layer 3: Render from iframe probe (DOM, interactions, layout issues) | âœ… Built | `snapshotRender()` |
| Mood personality in report (animation + typography tables) | âœ… Built | `formatThemeFromTokens()` includes `meta.personality` |
| Build metadata (modules, bundle size, deps, warnings) | âœ… Built | `extractBuildMeta()` |

### Skills Library (`src/skills/`)

| Piece | Status | Where |
|-------|--------|-------|
| Frontend Design skill (philosophy, anti-slop checklist) | âœ… Built | `frontend-design/SKILL.md` |
| Theming skill (full theme command guide, preset picker, pattern docs) | âœ… Built | `theming/SKILL.md` |
| Gumdrops skill (sequencing rules, diversity rules, page templates, reach maps, anti-slop database) | âœ… Built | `gumdrops/SKILL.md` |
| Extended Libraries skill (30+ npm packages with when-to-use) | âœ… Built | `extended-libraries/SKILL.md` |
| Code Quality skill | âœ… Built | `code-quality/SKILL.md` |
| Ralph skill (iteration loop, state files) | âœ… Built | `ralph/SKILL.md` |
| Creativity skill (redirects to gumdrops) | âœ… Built | `creativity/SKILL.md` â€” absorbed into gumdrops |

### Gumdrops Recipes (`src/skills/gumdrops/`)

| Domain | Recipe Count | Recipes |
|--------|-------------|---------|
| **marketing/** | 14 recipes âœ… | hero, features, pricing, testimonials, faq, cta, team, social-proof, contact, newsletter, blog-grid, gallery, portfolio, footer |
| **app/** | 21 recipes âœ… | activity-feed, ai-prompt, auth-login, calendar-view, chat-messaging, command-palette, data-table, dialog-modal, empty-state, file-browser, file-upload, form-layout, grid-list, kanban-board, notification-feed, onboarding, profile-page, search-results, settings-panel, sidebar-nav, stats-dashboard |
| **content/** | 4 recipes âœ… | article-layout, changelog, documentation, timeline |
| **interactive/** | 7 recipes âœ… | color-picker, drag-drop, keyboard-shortcuts, motion-patterns, multi-step-wizard, rich-text-editor, scroll-animation |
| **api/** | 0 (placeholder) | `.gitkeep` only â€” full-stack gumdrops deferred to Hono phase |

**Total: 46 recipes across 4 active domains.** Each follows the standard format: frontmatter (name, domain, intent, complexity, components) â†’ Recipe â†’ Variants â†’ Interaction Patterns â†’ Anti-Patterns â†’ Composition Notes.

### Gumdrops SKILL.md (Composition & Anti-Slop Rules)

All of the following are **already written** in `gumdrops/SKILL.md`:

- âœ… Sequencing rules (no adjacent repeats, density alternation, container variation, padding rhythm, background variety)
- âœ… Component diversity rules (min 10 types per page, max 2 Card sections, min 2 interactive, min 1 navigation)
- âœ… Page type templates (9 types with required gumdrops, min sections, min components)
- âœ… "Unexpected" rule (every 5+ section page needs one pattern-breaking section)
- âœ… Component reach map (basicâ†’betterâ†’best for 13 intents)
- âœ… Underused components table (12 components with what/where guidance)
- âœ… Anti-slop database: layout anti-patterns (5), component anti-patterns (5), theme anti-patterns (4) â€” each with detection signal + fix

### Ralph Loop (`src/lib/ralph/loop.ts`)

| Piece | Status | Where |
|-------|--------|-------|
| System prompt with design sensibility, engineering depth, toolkit | âœ… Built | `BASE_SYSTEM_PROMPT` |
| Quality gates (build success, structure, render) | âœ… Built | `runQualityGates()` |
| Gap recording (command-not-found tracking) | âœ… Built | `recordGap()` |
| Reflection system (harness reflection after iterations) | âœ… Built | `buildReflectionPrompt()`, `saveReflection()` |
| Observability types (GateContext, CommandAttempt, HarnessReflection) | âœ… Built | `types/observability.ts` |

---

## What's Actually Missing (the real gaps this timeline closes)

These are verified gaps â€” things that do NOT exist in the codebase as of 2026-02-16.

### Gap 1: Iteration Intelligence (no iteration vs fresh build distinction)

**Where:** `loop.ts` system prompt, `skills/frontend-design/SKILL.md`

Ralph's loop has zero awareness of whether this is iteration 1 (fresh build) or iteration 3+ (modifying existing work). No rule says "re-read design-brief.md before editing." No rule says "identify and edit ONLY the target section." No rule enforces component extraction (multi-section apps should split into separate files).

**Impact:** Brief gets forgotten. Timing drifts. Ralph rewrites files that shouldn't change. Observed directly in the energy drink iteration test â€” 300ms transition on an industrial brief that says 50-150ms.

### Gap 2: Seed Anchors & Justification

**Where:** `skills/theming/SKILL.md`

No hue landmark table (0=red/fire, 30=amber/warmth, 120=green/nature, etc.). No rule requiring seed justification in intent.md. Ralph picks seeds arbitrarily with no rationale connecting hue to project mood.

**Impact:** Theme choices feel random. No audit trail for "why this color?"

### Gap 3: Accessibility Notes in Design Brief

**Where:** `src/lib/theme-generator/personalities.ts`

`generateDesignBrief()` outputs typography, animation, spacing, interaction, and allowed/notAllowed â€” but never mentions accessibility. A `playful` mood with spring easing + fast timing emits no vestibular sensitivity warning. An `editorial` mood with thin fonts emits no low-vision readability note.

**Impact:** Ralph may produce technically valid but inaccessible designs without knowing.

### Gap 4: Custom Personality Override

**Where:** `src/lib/theme-generator/`, `theme.ts` shell command

Moods are closed presets â€” Ralph picks one of 12 but can't customize within. "Industrial base but with Orbitron and expo easing" requires Ralph to either: (a) pick industrial and manually override stuff, or (b) write everything from scratch. There's no `personality.json` input that lets Ralph express creative intent beyond mood selection.

**Impact:** The 12 moods are good starting points but become limiting for distinctive designs. Ralph can't compose "brutalist typography + organic spacing + playful animation."

### Gap 5: Preview Report Token Priority (Split Brain Risk)

**Where:** `src/lib/preview/snapshot.ts`

`snapshotTheme()` tries tokens.json FIRST, CSS as fallback. If Ralph manually edits CSS (bypassing theme commands), the report shows stale token data. No discrepancy detection. No flag saying "tokens.json says X but CSS says Y."

**Impact:** Ralph gets misleading feedback during iteration. Observed indirectly in iteration test where preview might not reflect actual rendered state.

### Gap 6: Automated Anti-Slop Enforcement

**Where:** `src/lib/ralph/gates.ts` (or wherever quality gates run)

The anti-slop rules exist in prose in `gumdrops/SKILL.md` â€” detection signals, fixes, thresholds. But they're **not enforced as automated gates**. The quality gate system checks that code *builds* and *renders*. It doesn't check that the design *isn't slop*. Three identical card grids in a row pass all current gates.

**Impact:** The rules exist but Ralph only follows them if it reads the skill (which it often doesn't on iteration). Automated enforcement would catch slop even when skills aren't consulted.

### Gap 7: Palette Sensitivity + Gradient Guidance

**Where:** `skills/theming/SKILL.md`, `skills/gumdrops/SKILL.md`

No guidance on which palette patterns work well with gradients (distant hues = good, adjacent = muddy). No notes on chroma sensitivity for different background treatments.

**Impact:** Minor â€” Ralph usually gets this right intuitively, but explicit guidance prevents edge cases.

### Gap 8: Edge-Case Contrast Tests

**Where:** `src/lib/theme-generator/generator.ts` or `__tests__/`

No explicit test coverage for contrast failure edge cases: yellow high-chroma (L near background), red low-chroma (near destructive), cyan gamut boundary, violet triadic (challenging contrast pairs). The contrast enforcement exists but hasn't been stress-tested against these known trouble spots.

**Impact:** Rare but possible contrast failures on extreme palette choices.

---

## Phase 1: Skills Tightening + Iteration Intelligence

> **Status:** âœ… Fully specced â€” ready for CC execution
> **CC prompt doc:** `cc-skills-tightening.md`
> **Estimated effort:** ~3-4 hours CC time
> **Depends on:** Nothing (all prerequisites built)
> **Closes gaps:** 1 (iteration intelligence), 2 (seed anchors), 3 (accessibility notes), 7 (palette sensitivity), 8 (edge-case contrast)

### What This Does

Surgical additions to existing skills and the Ralph loop. No new systems â€” tightens the guidance layer so Ralph uses the extensive existing tools correctly, especially during iteration.

### Changes by File

| File | What Changes |
|------|-------------|
| `skills/frontend-design/SKILL.md` | Add: component extraction rules (multi-section â†’ separate files), iteration rules (identify target, read only target + brief, rewrite only target) |
| `skills/theming/SKILL.md` | Add: seed anchor table (13 hue landmarks with emotional registers), design brief as iteration anchor guidance, palette sensitivity notes for gradient recipes |
| `skills/gumdrops/SKILL.md` | Add: gradient palette sensitivity note ("gradients work best with distant hues") |
| `loop.ts` | Add: iteration mode guidance in system prompt (filesystem check: brief + App.tsx exist â†’ iteration, not fresh build), seed justification requirement |
| `personalities.ts` | Add: `generateAccessibilityNotes()` function â€” analyzes mood properties (fast timing â†’ vestibular, thin fonts â†’ low-vision, low contrast preference â†’ check), appends to design brief |
| `generator.ts` or `__tests__/` | Add: edge-case contrast tests (yellow high-chroma, red low-chroma, cyan gamut boundary, violet triadic) |

### What This Does NOT Include (already built, was incorrectly scoped here previously)

- ~~`theme modify` command~~ â†’ Already fully built with `--shift-hue`, `--scope`, `--apply`, contrast re-enforcement, tokens.json sync
- ~~Expand moods from 6 to 12~~ â†’ All 12 already exist as full typed objects
- ~~Design brief output~~ â†’ Already works with `--mood` flag on both preset and generate

### Validation

After CC implements, run the energy drink test:
1. "Build me a bold energy drink landing page. Electric green, aggressive typography, fast animations."
2. Check: Did Ralph write seed justification? Read the brief? Use `theme generate` with `--mood`?
3. "Change the 4 flavor cards to a stacked fan layout"
4. Check: Did Ralph read the brief? Only touch the target section file? Timing within brief constraints?

---

## Phase 2: Custom Personality + Preview Fix

> **Status:** ğŸ”² Skeleton â€” needs CC prompt doc (`cc-dtcg-refinement.md`)
> **Estimated effort:** ~2-3 hours CC time (much smaller than originally scoped)
> **Depends on:** Phase 1 (iteration rules, accessibility notes)
> **Closes gaps:** 4 (custom personality), 5 (preview split brain)

### What This Does

Two focused additions:
1. Ralph can write a custom `personality.json` that mixes and overrides mood defaults
2. Preview report prioritizes actual CSS over tokens.json and flags discrepancies

### Scope

**A â€” Custom personality.json input:**
- Ralph writes `.ralph/personality.json` with overrides: font choices, typography hierarchy tweaks, animation timing/easing preferences, spacing density, interaction pattern changes
- `theme generate` gains `--personality .ralph/personality.json` flag
- Generator validates all values against existing registries (fonts, shadows, radii)
- Personality is applied ON TOP of `--mood` â€” mood provides defaults, personality overrides specific fields
- Output: CSS vars + tokens.json + design brief â€” all derived from mood + personality, all in sync
- This enables "industrial base + Orbitron + expo easing" without abandoning the mood system

**B â€” Preview report CSS-priority fix:**
- `snapshotTheme()` prioritizes parsing actual `src/index.css` over `tokens.json`
- When both exist AND disagree, report flags: "âš ï¸ tokens.json and CSS diverge on --primary"
- Report includes trace suggestions: "Spacing feels tight â†’ personality.json density is 'tight', brief says 48-64px"

### What This Does NOT Include (already built, was incorrectly scoped here previously)

- ~~Expand moods from 6 to 12~~ â†’ All 12 exist
- ~~Smart merge improvements~~ â†’ Smart merge already handles theme zone protection, contrast validation, @fonts extraction, custom CSS routing, full rewrite passthrough
- ~~Design brief generation~~ â†’ `generateDesignBrief()` already renders complete markdown from any of 12 moods

### What Needs to Happen Before CC Execution

Write `cc-dtcg-refinement.md` that:
1. Defines the personality.json schema (fields, types, which fields are overridable)
2. Specifies how `--personality` flag interacts with `--mood` (mood = base, personality = delta)
3. Specifies preview report changes (CSS-priority, discrepancy detection)
4. Lists every file to create/edit
5. Uses clean room format

### Open Questions

- Should `theme personality template --mood industrial` scaffold a starting personality.json?
- How much of the brief should be deterministic from personality vs mood defaults?
- Should personality support composing multiple moods? ("industrial + playful" base)

---

## Phase 3: Automated Anti-Slop Gates

> **Status:** ğŸ”² Skeleton â€” anti-pattern rules exist in prose, enforcement not built
> **Estimated effort:** ~4-6 hours CC time
> **Depends on:** Phase 1 (iteration intelligence), benefits from Phase 2 (personality-aware reports)
> **Closes gaps:** 6 (automated enforcement)

### What This Does

Turns the prose anti-slop rules in `gumdrops/SKILL.md` into automated validators that run as part of the quality gate system. The rules already exist â€” this phase makes them enforceable.

### Scope

**A â€” Layout diversity gate:**
- Parse section structure from Layer 3 DOM probe
- Flag: two adjacent sections with same grid pattern (from layout anti-patterns table)
- Flag: all sections use text-center mx-auto (from layout anti-patterns table)
- Flag: uniform padding across all sections (from layout anti-patterns table)
- Suggest: alternatives from gumdrops composition rules

**B â€” Component diversity gate:**
- Count distinct @wiggum/stack component types from Layer 2 import analysis
- Enforce existing thresholds from gumdrops SKILL.md: min 10 types per full page, max 2 Card sections, min 2 interactive, min 1 navigation
- Flag: component poverty (< 8 distinct types)
- Flag: zero interactive components

**C â€” Theme compliance gate:**
- Scan source files for hardcoded colors (`bg-blue-500`, `text-gray-700`)
- Scan for hardcoded OKLCH outside theme zone in index.css
- Verify custom CSS utilities use `var(--token)` not literal values

**D â€” Integration with preview report:**
- Anti-slop results appear as a new section in the snapshot report
- Ralph reads the report and can self-correct before marking complete
- Severity levels: error (blocks completion), warning (noted in report), info (suggestion)
- Gate results feed back into the Ralph loop as actionable feedback

### What This Does NOT Include (already exists as prose)

- ~~Anti-slop detection rules~~ â†’ Already written in gumdrops SKILL.md with detection signals + fixes
- ~~Component reach maps~~ â†’ Already written (basicâ†’betterâ†’best for 13 intents)
- ~~Sequencing rules~~ â†’ Already written (density alternation, container variation, etc.)
- ~~Page type templates~~ â†’ Already written (9 types with required gumdrops)

The difference: prose rules rely on Ralph reading and following the skill. Automated gates enforce regardless.

### What Needs to Happen Before CC Execution

Write `cc-anti-slop-gates.md` that:
1. Defines detection heuristics for each gate (what DOM/source patterns indicate slop)
2. Maps each gate to the specific prose rule it automates (traceability)
3. Defines severity levels and thresholds
4. Specifies integration with existing `runQualityGates()` in loop.ts
5. Specifies test cases: what passes, what fails, edge cases
6. Determines whether gates block completion or warn

### Open Questions

- How aggressive should gates be? Too strict = Ralph stuck in correction loops. Too loose = slop passes.
- Should gates run on every preview or only on final completion check?
- Can gates suggest specific fixes from gumdrops recipes, or just flag problems?
- Should there be a `--strict` vs `--lenient` mode for different project types?

---

## Deferred: Component Decision Tree (Small Gap)

> **Why deferred:** The system prompt already says "NEVER write raw HTML when stack exists." Gumdrops SKILL.md has component reach maps and underused components guidance. The formal "STOP! 4-step decision flow" from `wiggum-powerup-plan.md` Phase 5A would be nice but is incremental polish, not a critical gap.

> **If/when we do it:** Add a dedicated section to `skills/wiggum-stack/SKILL.md` or `skills/code-quality/SKILL.md` with the 4-step flow: exists in stack? â†’ compose from stack? â†’ extend via CSS vars? â†’ check extended-libraries registry? Estimated effort: 30 minutes, can be folded into any phase.

---

## Deferred: Gumdrops Content Expansion (No Gap)

> **Why deferred:** 46 recipes exist across 4 active domains. Marketing (14), App (21), Content (4), Interactive (7). All follow the standard format. The API domain is intentionally empty pending Hono full-stack phase. Content domain could use 2-3 more recipes (portfolio standalone, gallery standalone) but these overlap with marketing/ recipes that already exist. Not worth a CC session.

> **If/when we do it:** Add portfolio.md and gallery.md to content/ if the marketing/ versions prove insufficient. Can be done ad-hoc.

---

## Dependency Graph

```
Phase 1: Skills Tightening + Iteration Intelligence
    â”‚
    â”œâ”€â”€â†’ Phase 2: Custom Personality + Preview Fix
    â”‚        â”‚
    â”‚        â””â”€â”€â†’ Phase 3: Automated Anti-Slop Gates (benefits from personality-aware reports)
    â”‚
    â””â”€â”€â†’ Phase 3: Automated Anti-Slop Gates (can start after Phase 1, benefits from Phase 2)
```

**Critical path:** 1 â†’ 2 â†’ 3

**Can parallelize:** Phase 3 can start after Phase 1 if Phase 2 isn't ready yet. The gates don't need the personality system â€” they operate on DOM structure and source analysis.

**Total estimated effort:** ~9-13 hours CC time (down from ~25-35 in the original timeline)

---

## Execution Protocol

Same two-model review loop as `cc-implementation-timeline.md`:

1. **Update CLAUDE.md** â€” set current phase, list docs to read
2. **CC: Plan** â€” "Read the spec. Explore the codebase. Make your implementation plan. Don't code."
3. **Review in Claude.ai** â€” catch wrong layer, missing edge cases, code too close to reference
4. **Send corrections** â€” specific, numbered, no ambiguity
5. **CC: Execute** â€” phase by phase, test between phases
6. **Snapshot** â€” git commit + branch before moving to next phase

### Per-Phase CC Docs

| Phase | CC Prompt Doc | Status |
|-------|--------------|--------|
| 1 | `cc-skills-tightening.md` | âœ… Complete (needs minor update: remove theme modify, remove mood expansion) |
| 2 | `cc-dtcg-refinement.md` | ğŸ”² Needs writing (much smaller scope than originally planned) |
| 3 | `cc-anti-slop-gates.md` | ğŸ”² Needs writing |

---

## Validation: The Energy Drink Test

After each phase, re-run the energy drink test and measure progress:

**Prompt 1:** "Build me a bold energy drink landing page. Electric green, aggressive typography, fast animations. Hero section, flavor grid with 4 cards, CTA."

**Prompt 2:** "Change the 4 flavor cards to a stacked fan layout â€” cards overlapping with slight rotation, click to bring a card to front."

### Expected Progression

| Signal | Baseline (today) | After Phase 1 | After Phase 2 | After Phase 3 |
|--------|------------------|---------------|---------------|---------------|
| Theme pipeline used correctly | âš ï¸ Sometimes bypassed | âœ… Seed justification + `theme generate --mood` | âœ… Custom personality.json | âœ… Same |
| Brief consulted on iteration | âŒ Never read | âœ… Iteration rules enforce it | âœ… Richer brief from personality | âœ… Same |
| Split brain (tokens vs CSS) | âš ï¸ Possible | âš ï¸ Same | âœ… Fixed (report prioritizes CSS, flags divergence) | âœ… Same |
| Animation timing drift | 300ms unconscious | 150ms or deliberate override | Same | Same |
| Accessibility warnings | âŒ None | âœ… Vestibular/low-vision notes in brief | âœ… Same | âœ… Same |
| Structure diversity | Already has recipes | Same (rules exist, not enforced) | Same | âœ… Gates flag repetitive layout |
| Component diversity | Already has reach maps | Same (rules exist, not enforced) | Same | âœ… Gates flag component poverty |
| Hardcoded values in CSS | âš ï¸ Glow utilities | âœ… Skills enforce var() | âœ… Same | âœ… Gate catches any remaining |

---

## Relationship to Main Timeline

This document covers a focused vertical slice of `cc-implementation-timeline.md`, reorganized around design quality.

Where they intersect:
- **Phase 1 here** â‰ˆ prerequisite for B4 there
- **Phase 2 here** = was implicit in "personality brief system" (now scoped correctly)
- **Phase 3 here** = quality gate portions of E, pulled forward (don't need WFC solver)
- **Gumdrops work** = B1-B3 there, but already built (46 recipes). API gumdrops (B3) stay in D5 (Hono phase)
- **Component patterns** = A3 there, but mostly done. Deferred as incremental polish.

### What Was Removed From Original Timeline (Already Built)

For future reference, these items were in the original version of this timeline but were found to already exist during the 2026-02-16 codebase audit:

- `theme modify` command â€” fully built with `--shift-hue`, `--scope`, `--apply`, contrast re-enforcement, tokens.json sync
- 12 personality moods â€” all 12 exist as full typed PersonalityBrief objects in `personalities.ts`
- `--mood` flag â€” works on both `theme preset` and `theme generate`
- Auto-inferred moods per preset â€” `PRESET_MOOD_MAP` in `theme.ts`
- Marketing gumdrops (14 recipes) â€” hero, features, pricing, testimonials, faq, cta, team, social-proof, contact, newsletter, blog-grid, gallery, portfolio, footer
- Content gumdrops (4 recipes) â€” article-layout, changelog, documentation, timeline
- Interactive gumdrops (7 recipes) â€” color-picker, drag-drop, keyboard-shortcuts, motion-patterns, multi-step-wizard, rich-text-editor, scroll-animation
- App gumdrops (21 recipes) â€” full set including stats-dashboard, kanban-board, chat-messaging, etc.
- Composition rules â€” sequencing, density alternation, container variation, padding rhythm, background variety
- Component diversity rules â€” min types, max Card sections, interactive minimums
- Component reach maps â€” basicâ†’betterâ†’best for 13 intents
- Anti-slop database (prose) â€” layout, component, and theme anti-patterns with detection signals
- Smart CSS merge â€” theme zone protection, contrast validation, @fonts extraction, custom CSS routing
- 3-layer preview system â€” theme + structure + render snapshots
